<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="optimall">
<title>Splitting Strata with Optimall Shiny • optimall</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Splitting Strata with Optimall Shiny">
<meta property="og:description" content="optimall">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">optimall</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Multiwave-Estimation.html">Estimation in Two-phase, Multi-wave sampling</a>
    <a class="dropdown-item" href="../articles/Multiwave-Object.html">Multiwave Object</a>
    <a class="dropdown-item" href="../articles/optimall-vignette.html">Using Optimall</a>
    <a class="dropdown-item" href="../articles/using-optimall_shiny.html">Splitting Strata with Optimall Shiny</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/yangjasp/optimall/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Splitting Strata with Optimall Shiny</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yangjasp/optimall/blob/HEAD/vignettes/using-optimall_shiny.Rmd" class="external-link"><code>vignettes/using-optimall_shiny.Rmd</code></a></small>
      <div class="d-none name"><code>using-optimall_shiny.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The function <code><a href="../reference/optimall_shiny.html">optimall_shiny()</a></code>, located within the
package <code>optimall</code>, launches a Shiny app that allows users to
observe how the stratum sizes, standard deviations, and optimum
allocations react to different stratum splits. This vignette
demonstrates how to use the application.</p>
</div>
<div class="section level2">
<h2 id="uploading-data">Uploading Data<a class="anchor" aria-label="anchor" href="#uploading-data"></a>
</h2>
<p>The first step in using <code><a href="../reference/optimall_shiny.html">optimall_shiny()</a></code> is uploading
data. The data must be in the same format that the rest of
<code>optimall</code>’s functions require, meaning that each row must
corresponds to one sampling unit. If you have already updated an
existing dataset in your R workflow, you will have to save the updated
dataframe to a .csv file in order to work with it in
<code><a href="../reference/optimall_shiny.html">optimall_shiny()</a></code>.</p>
<center>
<br><img src="../inst/shiny-app/optimall_shiny/Screenshots/Screenshot3.png" style="width:80.0%" alt="Alt text">
</center>
<p><br></p>
</div>
<div class="section level2">
<h2 id="splitting-strata">Splitting Strata<a class="anchor" aria-label="anchor" href="#splitting-strata"></a>
</h2>
<p>Once the dataset has been uploaded, options for the user to select
inputs will appear. Each input correspond to an argument of at least one
function in <code>optimall</code>, and the application provides a list
of valid options for each one based on the uploaded data. See them
below:</p>
<ul>
<li><p><strong>Column Holding Strata</strong> corresponds to the
<code>strata</code> argument in <code><a href="../reference/split_strata.html">split_strata()</a></code>. The
dropdown menu includes a list of column names from which the user should
choose the name of the column that defines the stratum that each unit
belongs to.</p></li>
<li><p><strong>Column Holding Variable to Split On</strong> corresponds
to the <code>split_var</code> argument in <code><a href="../reference/split_strata.html">split_strata()</a></code>.
The dropdown menu includes a list of column names from which the user
should choose the name of the column that holds the variable (continuous
or categorical) that will be used to split strata on.</p></li>
<li><p><strong>Column Holding Variable of Interest</strong> corresponds
to the <code>y</code> argument in <code><a href="../reference/optimum_allocation.html">optimum_allocation()</a></code> or
<code><a href="../reference/allocate_wave.html">allocate_wave()</a></code>. The dropdown menu again includes a list of
column names from which the user should choose the column holding the
variable of interest. Since the application displays, it needs to know
this variable of interest, <code>y</code>, in order to calculate the
optimum allocation.</p></li>
<li><p><strong>Name of Strata to Split</strong> corresponds to the
<code>split</code> argument in <code><a href="../reference/split_strata.html">split_strata()</a></code>. The dropdown
menu includes a list of the unique stratum names from the column holding
strata. Although the package allows for multiple strata to be selected
in the same call, the Shiny application currently supports only one (or
all) strata to be split at once.</p></li>
<li><p><strong>Split Type</strong> corresponds to the
<code>split_type</code> argument in <code><a href="../reference/split_strata.html">split_strata()</a></code>. If the
variable to split on is not numeric, the type must be categorical. For
more details on each option, see the documentation at
<code><a href="../reference/split_strata.html">?split_strata</a></code>.</p></li>
<li><p><strong>Split At</strong> corresponds to the
<code>split_at</code> argument in <code><a href="../reference/split_strata.html">split_strata()</a></code>. If the
split type is one of global quantile, local quantile, or value, this
input will be a slider for the user to adjust the exact split location.
If the split type is categorical, this input will contain boxes for each
unique value of the <code>split_var</code>. In the categorical case, the
checked boxes will be interpreted as category 1, while the unchecked
boxes will be category 0.</p></li>
<li><p><strong>Include Information from Previous Wave</strong> allows
users to select if the displayed dataframe should be output from
<code><a href="../reference/optimum_allocation.html">optimum_allocation()</a></code> or <code><a href="../reference/allocate_wave.html">allocate_wave()</a></code>. If
<code><a href="../reference/optimum_allocation.html">optimum_allocation()</a></code> is chosen, it defaults to the
“WrightII” method with <code>allow.na = TRUE</code>. If
<code><a href="../reference/allocate_wave.html">allocate_wave()</a></code> is chosen, a new option to to select which
column contains the prior wave indicator will appear, and a valid column
(containing 0/1 or Y/N) must be selected. This choice corresponds to the
<code>wave2a</code> argument of <code><a href="../reference/allocate_wave.html">allocate_wave()</a></code>.</p></li>
<li><p><strong>n to sample</strong> allows users to indicate the number
of samples to be taken for the output dataframe. This selection
corresponds to the <code>nsample</code> argument of either
<code><a href="../reference/optimum_allocation.html">optimum_allocation()</a></code> or <code><a href="../reference/allocate_wave.html">allocate_wave()</a></code>. Thus,
it should be different depending on which allocation function was
selected. For <code><a href="../reference/optimum_allocation.html">optimum_allocation()</a></code>, it should be the total
number of samples to be taken, while for <code><a href="../reference/allocate_wave.html">allocate_wave()</a></code>,
it only indicates how many samples should be taken in the <em>current
wave</em>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p><code><a href="../reference/optimall_shiny.html">optimall_shiny()</a></code> displays the output dataframe of
<code><a href="../reference/optimum_allocation.html">optimum_allocation()</a></code> or <code><a href="../reference/allocate_wave.html">allocate_wave()</a></code> based
on the current inputs. After a split is confirmed and these inputs are
reset, it will show an error in place of this dataframe until valid
inputs are selected again. Displayed below this dataframe is a text list
of the code that performs each of the confirmed splits in
<code>optimall</code>.</p>
<center>
<br><img src="../inst/shiny-app/optimall_shiny/Screenshots/Screenshot4.png" style="width:98.0%" alt="Alt text">
</center>
<p><br></p>
</div>
<div class="section level2">
<h2 id="confirming-splits">Confirming Splits<a class="anchor" aria-label="anchor" href="#confirming-splits"></a>
</h2>
<p>When the user is satisfied with the parameters that are selected, a
split can be confirmed by pressing the <code>Confirm Split</code> button
at the bottom left of the page. This will split the existing data using
the <code><a href="../reference/split_strata.html">split_strata()</a></code> parameters specified in the inputs. The
inputs that specify arguments for the allocation will not change the
splits, they are only included to show how each split may impact the
sample allocation.</p>
<p>After <code>Confirm Split</code> is pressed, the code to perform that
split will appear in the output at the bottom right of the page. The
updated strata will now be in a column called “new_strata”, and the
inputs will reset. Using “new_strata” as the column defining the strata,
the user can then perform more splits, and the code to perform each one
will be added to the list at the bottom right with each
confirmation.</p>
</div>
<div class="section level2">
<h2 id="implementing-splits-in-r">Implementing Splits in R<a class="anchor" aria-label="anchor" href="#implementing-splits-in-r"></a>
</h2>
<p>The splits in <code><a href="../reference/optimall_shiny.html">optimall_shiny()</a></code> will not be performed on
the true dataset in the user’s <code>optimall</code> workflow in R.
Instead, the user must return to R if they want to actually transform
the data into a working dataframe with the new strata. The code
displayed in the app’s output makes this task simple, as it can be
copied and pasted into an R script to replicate the splits conducted in
the app. Note, however, that the <code>data</code> argument in each
<code><a href="../reference/split_strata.html">split_strata()</a></code> call needs to be changed to reflect the
user’s name for the data.</p>
</div>
<div class="section level2">
<h2 id="error-messages">Error Messages<a class="anchor" aria-label="anchor" href="#error-messages"></a>
</h2>
<p>If any of the selected inputs results in an error in either
<code><a href="../reference/split_strata.html">split_strata()</a></code> or the selected allocation function, the app
will print the error.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jasper Yang, Pamela Shaw.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
