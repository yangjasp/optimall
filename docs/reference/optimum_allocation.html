<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Determines the optimum sampling fraction and sample size for
each stratum in a stratified random sample, which
minimizes the variance of the sample mean according to Neyman
Allocation or Exact Optimum Sample Allocation (Wright 2014)."><title>Optimum Allocation — optimum_allocation • optimall</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimum Allocation — optimum_allocation"><meta property="og:description" content="Determines the optimum sampling fraction and sample size for
each stratum in a stratified random sample, which
minimizes the variance of the sample mean according to Neyman
Allocation or Exact Optimum Sample Allocation (Wright 2014)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">optimall</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/yangjasp/optimall/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Optimum Allocation</h1>
      <small class="dont-index">Source: <a href="https://github.com/yangjasp/optimall/blob/HEAD/R/optimum_allocation.R" class="external-link"><code>R/optimum_allocation.R</code></a></small>
      <div class="d-none name"><code>optimum_allocation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Determines the optimum sampling fraction and sample size for
each stratum in a stratified random sample, which
minimizes the variance of the sample mean according to Neyman
Allocation or Exact Optimum Sample Allocation (Wright 2014).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">optimum_allocation</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">strata</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sd_h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N_h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nsample <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ndigits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WrightII"</span>, <span class="st">"WrightI"</span>, <span class="st">"Neyman"</span><span class="op">)</span>,</span>
<span>  allow.na <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A data frame or matrix with at least one column specifying
each unit's stratum, and either 1) a second column holding the value of the
continuous variable for which the sample mean variance should be minimized
(<code>y</code>) or 2) two columns: one holding the the within-stratum
standard deviation for the variable of interest (<code>sd_h</code>) and another
holding the stratum sample sizes (<code>N_h</code>).
If <code>data</code> contains a column <code>y</code> holding values for
the variable of interest, then <code>data</code> should have one row for
each sampled unit. If <code>data</code> holds <code>sd_h</code> and <code>N_h</code>, the
within-stratum standard deviations and population sizes, then <code>data</code>
should have one row per stratum.
Other columns are allowed but will be ignored.</p></dd>


<dt>strata</dt>
<dd><p>a character string or vector of character strings
specifying the name(s) of columns which specify the stratum
that each unit belongs to. If multiple column names are
provided, each unique combination of values in these columns
is taken to define one stratum.</p></dd>


<dt>y</dt>
<dd><p>a character string specifying the name of the
continuous variable for which the variance should be minimized.
Defaults to <code>NULL</code> and should be left as <code>NULL</code> when <code>data</code>
holds stratum standard deviations and sample sizes instead of individual
sampling units.</p></dd>


<dt>sd_h</dt>
<dd><p>a character string specifying the name of the
column holding the within-stratum standard deviations for each stratum.
Defaults to <code>NULL</code> and should be left as <code>NULL</code> when <code>data</code>
holds individual sampling units.</p></dd>


<dt>N_h</dt>
<dd><p>a character string specifying the name of the
column holding the population stratum sizes for each stratum.
Defaults to <code>NULL</code> and should be left as <code>NULL</code> when <code>data</code>
holds individual sampling units.</p></dd>


<dt>nsample</dt>
<dd><p>the desired total sample size. Defaults to <code>NULL</code>.</p></dd>


<dt>ndigits</dt>
<dd><p>a numeric value specifying the number of digits
to which the standard deviation and stratum fraction should be rounded.
Defaults to 2.</p></dd>


<dt>method</dt>
<dd><p>a character string specifying the method of
optimum sample allocation to use. Must be one of:</p><ul><li><p><code>"WrightII"</code>, the default, uses Algorithm II from
Wright (2014) to determine the optimum allocation of a fixed
sample size across the strata. It requires that at least two
samples are allocated to each stratum.</p></li>
<li><p><code>"WrightI"</code> uses Wright's Algorithm I to determine
the optimum sample allocation. It only requires that at least
one sample is allocated to each stratum, and can therefore
lead to a biased variance estimate.</p></li>
<li><p><code>"Neyman"</code> uses the standard method of Neyman
Allocation to determine the optimum sample allocation. When
<code>nsample = NULL</code>, the optimal sampling fraction is calculated
and returned. When a numeric value is specified for <code>nsample</code>,
then the number allocated to each stratum is the optimal sampling
fraction times <code>nsample</code> rounded to the nearest integer,
which may no longer be optimall.</p></li>
</ul></dd>


<dt>allow.na</dt>
<dd><p>logical input specifying whether y should
be allowed to have NA values. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a data frame with the number of samples allocated to each
stratum, or just the sampling fractions if nsample is NULL.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wright, T. (2014). A Simple Method of Exact Optimal
Sample Allocation under Stratification with any Mixed
Constraint Patterns, Research Report Series (Statistics #2014-07),
Center for Statistical Research and Methodology, U.S. Bureau
of the Census, Washington, D.C.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">optimum_allocation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">iris</span>, strata <span class="op">=</span> <span class="st">"Species"</span>, y <span class="op">=</span> <span class="st">"Sepal.Length"</span>,</span></span>
<span class="r-in"><span>  nsample <span class="op">=</span> <span class="fl">40</span>, method <span class="op">=</span> <span class="st">"WrightII"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       strata npop   sd  n_sd stratum_fraction stratum_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa   50 0.35 17.62             0.22            9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor   50 0.52 25.81             0.35           14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica   50 0.64 31.79             0.42           17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or if input data is summary of strata sd and N:</span></span></span>
<span class="r-in"><span><span class="va">iris_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3791</span>, <span class="fl">0.3138</span>, <span class="fl">0.3225</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">optimum_allocation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">iris_summary</span>, strata <span class="op">=</span> <span class="st">"strata"</span>,</span></span>
<span class="r-in"><span>  sd_h <span class="op">=</span> <span class="st">"sd"</span>, N_h <span class="op">=</span> <span class="st">"size"</span>,</span></span>
<span class="r-in"><span>  nsample <span class="op">=</span> <span class="fl">40</span>, method <span class="op">=</span> <span class="st">"WrightII"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       strata npop   sd  n_sd stratum_fraction stratum_size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     setosa   50 0.38 18.95             0.38           15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 versicolor   50 0.31 15.69             0.30           12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  virginica   50 0.32 16.12             0.32           13</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jasper Yang, Pamela Shaw.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

