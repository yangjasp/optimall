<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Splits pre-defined sampling strata based on values of a
continuous or categorical variable."><title>Split Strata — split_strata • optimall</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Split Strata — split_strata"><meta property="og:description" content="Splits pre-defined sampling strata based on values of a
continuous or categorical variable."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">optimall</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Multiwave-Estimation.html">Estimation in Two-phase, Multi-wave sampling</a>
    <a class="dropdown-item" href="../articles/Multiwave-Object.html">Multiwave Object</a>
    <a class="dropdown-item" href="../articles/optimall-vignette.html">Using Optimall</a>
    <a class="dropdown-item" href="../articles/using-optimall_shiny.html">Splitting Strata with Optimall Shiny</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/yangjasp/optimall/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Split Strata</h1>
      <small class="dont-index">Source: <a href="https://github.com/yangjasp/optimall/blob/HEAD/R/split_strata.R" class="external-link"><code>R/split_strata.R</code></a></small>
      <div class="d-none name"><code>split_strata.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Splits pre-defined sampling strata based on values of a
continuous or categorical variable.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">split_strata</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">strata</span>,</span>
<span>  split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">split_var</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"global quantile"</span>,</span>
<span>  split_at <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  trunc <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>a dataframe or matrix with one row for each
sampling unit, one column specifying each unit's current
stratum, one column containing the continuous or categorical
values that will define the split, and any other relevant
columns.</p></dd>


<dt>strata</dt>
<dd><p>a character string specifying the name of the
column that defines each unit's current strata.</p></dd>


<dt>split</dt>
<dd><p>the name of the stratum or strata to be split,
exactly as they appear in <code>strata</code>. Defaults to NULL,
which indicates that all strata in <code>strata</code> will be split.</p></dd>


<dt>split_var</dt>
<dd><p>a character string specifying the name of the
column that should be used to define the strata splits.</p></dd>


<dt>type</dt>
<dd><p>a character string specifying how the function
should interpret the <code>split_at</code> argument. Must be one of:</p><ul><li><p><code>"global quantile"</code>, the default, splits the strata
at the quantiles specified in <code>split_at</code> defined along
the entire, unfiltered <code>split_var</code> column.</p></li>
<li><p><code>"local quantile"</code> splits the strata at the
quantiles specified in <code>split_at</code> defined along the
filtered <code>split_var</code> column which only includes units in
the stratum being split.</p></li>
<li><p><code>"value"</code> splits the strata at the values specified
in <code>split_at</code> along <code>split_var</code> column.</p></li>
<li><p><code>"categorical"</code> splits the strata into two new
strata, one that contains each unit where <code>split_var</code>
matches an input of <code>split_at</code>, and a second that contains
every other unit.</p></li>
</ul></dd>


<dt>split_at</dt>
<dd><p>the percentile, value, or name(s) which
<code>split_var</code> should be split at. The interpretation of
this input depends on <code>type</code>. For <code>"quantile"</code> types,
input must be between <code>0</code> and <code>1</code>. Defaults to
<code>0.5</code> (median). For <code>"categorical"</code> type, the
input should be a vector of values or names in <code>split_var</code>
that define the new stratum.</p></dd>


<dt>trunc</dt>
<dd><p>A numeric or character value specifying how the
name of the <code>split_var</code> should be truncated when naming
the new strata. If numeric, the new strata name will only
include the first 'n' characters of the <code>split_var</code> name.
If character, the specified string will be used to name the new
strata instead of the <code>split_var</code> name. Defaults to
<code>NULL</code>, which creates the new strata name using the entire
name of the <code>split_var</code> column.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns the input dataframe with a new column named
'new_strata' that holds the name of the stratum that each
sample belongs to after the split. The column containing the
previous strata names is retained and given the name "old_strata".</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For splits on continuous variables, the new strata are defined
on left-open intervals. The only exception is the first interval,
which must include the overall minimum value. The names of the newly
created strata for a split generated
from a continuous value are the <code>split_var</code> column name with
the range of values defining that stratum appended to the
old strata name. For a categorical split, the new strata names
are the <code>split_var</code> column name appended to the
1/0 logical flag specifying whether the unit is in <code>split at</code>,
all appended to the old strata name.
If the <code>split_var</code> column name is long,
the user can specify a value for <code>trunc</code> to prevent the new
strata names from being inconveniently long.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">split_strata</span><span class="op">(</span><span class="va">iris</span>, <span class="st">"Sepal.Length"</span>,</span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  split <span class="op">=</span> <span class="st">"setosa"</span>, split_var <span class="op">=</span> <span class="st">"Sepal.Width"</span>,</span></span>
<span class="r-in"><span>  split_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"global quantile"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can split at more than one quantile in one call.</span></span></span>
<span class="r-in"><span><span class="co"># The above call splits the "setosa" stratum into three of equal size</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">split_strata</span><span class="op">(</span><span class="va">iris</span>, <span class="st">"Sepal.Length"</span>,</span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  split <span class="op">=</span> <span class="st">"setosa"</span>, split_var <span class="op">=</span> <span class="st">"Sepal.Width"</span>, split_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.33</span>, <span class="fl">0.66</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"local quantile"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Manually select split values with type = "value"</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">split_strata</span><span class="op">(</span><span class="va">iris</span>, <span class="st">"Sepal.Length"</span>,</span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="st">"Species"</span>,</span></span>
<span class="r-in"><span>  split <span class="op">=</span> <span class="st">"setosa"</span>, split_var <span class="op">=</span> <span class="st">"Sepal.Width"</span>,</span></span>
<span class="r-in"><span>  split_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.1</span>, <span class="fl">3.8</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"value"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform a categorical split.</span></span></span>
<span class="r-in"><span><span class="va">iris</span><span class="op">$</span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, times <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, times <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">split_strata</span><span class="op">(</span><span class="va">iris</span>, <span class="st">"Sepal.Length"</span>,</span></span>
<span class="r-in"><span>  strata <span class="op">=</span> <span class="st">"strata"</span>,</span></span>
<span class="r-in"><span>  split <span class="op">=</span> <span class="cn">NULL</span>, split_var <span class="op">=</span> <span class="st">"Species"</span>,</span></span>
<span class="r-in"><span>  split_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"virginica"</span>, <span class="st">"versicolor"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"categorical"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Splits each initial strata 1 and 2 into one stratum with "virginia"</span></span></span>
<span class="r-in"><span><span class="co"># and "versicolor" species and one stratum with all of the other species</span></span></span>
<span class="r-in"><span><span class="co"># not specified in the split_at argument.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jasper Yang, Pamela Shaw.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

